<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏µ‡πâ">
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob:;
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.firebaseapp.com https://*.googleapis.com https://*.gstatic.com https://cdn.datatables.net https://code.jquery.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://cdn.datatables.net;
        style-src-elem 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://cdn.datatables.net;
        font-src 'self' data: https://fonts.gstatic.com https://cdnjs.cloudflare.com;
        img-src 'self' data: blob: https:;
        connect-src 'self' https://*.firebaseapp.com https://*.googleapis.com https://*.gstatic.com https://cdn.datatables.net https://code.jquery.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com;
        frame-src 'none';
        object-src 'none';
        base-uri 'self';
        form-action 'self';
    ">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏µ‡πâ - ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∞</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="../../manifest.json">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans Thai -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../css/style.css?v=4.0.0">
    <link rel="stylesheet" href="../../css/login.css?v=4.0.0">
    <link rel="stylesheet" href="../../css/dashboard-styles.css?v=4.0.0">
    <link rel="stylesheet" href="../../css/debtor-dashboard.css">
    <link rel="stylesheet" href="../../css/performance.css?v=4.0.0">
    <link rel="stylesheet" href="../../css/mobile-chrome-fix.css?v=4.0.0">
    
    <style>
        .dashboard-header {
            background-color: #1e3a8a;
            border-bottom: 1px solid #1e40af;
            padding: 0.75rem 0;
        }
        
        .dashboard-header .nav-link {
            color: #ffffff;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            margin: 0 0.25rem;
            transition: all 0.3s ease;
        }
        
        .dashboard-header .nav-link:hover,
        .dashboard-header .nav-link.active {
            background-color: #3b82f6;
            color: #ffffff;
        }
        
        /* Prevent navigation menu from wrapping on large screens */
        .dashboard-header .nav {
            flex-wrap: nowrap;
            white-space: nowrap;
        }
        
        .dashboard-header .nav-link {
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        /* Mobile Responsive Styles */
        @media (max-width: 767.98px) {
            .dashboard-header {
                padding: 0.5rem 0;
            }
            
            .dashboard-header h1 {
                font-size: 0.9rem !important;
            }
            
            .dashboard-header .btn {
                padding: 0.25rem 0.5rem;
                font-size: 0.8rem;
            }
            
            .dashboard-header .badge,
            /* .notification-badge-mobile {
                font-size: 0.5rem !important;
                padding: 0.2em 0.4em;
            } */ /* Removed - notifications not used */
            
            /* Mobile menu button styling */
            .dashboard-header .btn-outline-light {
                border-color: rgba(255, 255, 255, 0.5);
                color: #ffffff;
            }
            
            .dashboard-header .btn-outline-light:hover {
                background-color: rgba(255, 255, 255, 0.1);
                border-color: #ffffff;
                color: #ffffff;
            }
        }
        
        /* Small mobile devices */
        @media (max-width: 575.98px) {
            .dashboard-header h1 {
                font-size: 0.8rem !important;
            }
            
            .dashboard-header .btn {
                padding: 0.2rem 0.4rem;
                font-size: 0.75rem;
            }
        }
        
        /* Mobile Offcanvas Styles */
        .offcanvas {
            width: 280px !important;
        }
        
        .offcanvas-header {
            background-color: #1e3a8a;
            color: white;
            border-bottom: 1px solid #1e40af;
        }
        
        .offcanvas-title {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .offcanvas-body .nav-link {
            padding: 0.75rem 1rem;
            border-radius: 6px;
            margin-bottom: 0.25rem;
            transition: all 0.3s ease;
            color: #212529 !important;
            font-weight: 500;
        }
        
        .offcanvas-body .nav-link:hover {
            background-color: #f8f9fa;
            color: #1e3a8a;
        }
        
        .offcanvas-body .nav-link.active {
            background-color: #1e3a8a;
            color: white !important;
        }
        
        .offcanvas-body .nav-link.text-danger {
            color: #dc3545 !important;
        }
        
        .offcanvas-body .nav-link.text-danger:hover {
            background-color: #f8d7da;
            color: #721c24 !important;
        }
        

        
        .main-content {
            padding: 2rem;
        }
        
        /* Mobile Main Content */
        @media (max-width: 767.98px) {
            .main-content {
                padding: 1rem 0.75rem;
            }
            
            .stats-card {
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .stats-card h3 {
                font-size: 1.25rem;
            }
            
            .stats-card p {
                font-size: 0.85rem;
            }
            
            .stats-icon {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
        }
        
        @media (max-width: 575.98px) {
            .main-content {
                padding: 0.75rem 0.5rem;
            }
            
            .stats-card {
                padding: 0.75rem;
            }
            
            .stats-card h3 {
                font-size: 1.1rem;
            }
            
            .stats-card p {
                font-size: 0.8rem;
            }
            
            .stats-icon {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
        }
        
        .stats-card {
            background-color: var(--white);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .stats-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .stats-icon.primary {
            background-color: var(--primary);
            color: var(--white);
        }
        
        .stats-icon.success {
            background-color: var(--success);
            color: var(--white);
        }
        
        .stats-icon.warning {
            background-color: var(--warning);
            color: var(--white);
        }
        
        .stats-icon.danger {
            background-color: var(--danger);
            color: var(--white);
        }
        
        .debt-list {
            background-color: var(--white);
            border: 1px solid var(--border);
            border-radius: 8px;
        }
        
        .debt-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        /* Chart Styles */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 0 auto;
        }
        
        .chart-container canvas {
            max-height: 300px;
        }
        
        .stats-card canvas {
            max-height: 250px;
        }
        
        /* Responsive chart adjustments */
        @media (max-width: 768px) {
            .chart-container {
                height: 250px;
            }
            
            .stats-card canvas {
                max-height: 200px;
            }
        }
        }
        
        .debt-item:last-child {
            border-bottom: none;
        }
        
        .debt-item-content {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
        }
        
        .debt-avatar {
            flex-shrink: 0;
        }
        
        .debt-info {
            flex: 1;
            min-width: 0;
        }
        
        .debt-status {
            flex-shrink: 0;
        }
        
        .debt-amount {
            flex-shrink: 0;
            text-align: right;
        }
        
        .debt-date {
            flex-shrink: 0;
            text-align: right;
        }
        
        .debt-actions {
            flex-shrink: 0;
        }
        
        .creditor-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        
        /* Responsive adjustments for debt items */
        @media (max-width: 768px) {
            .debt-item-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .debt-amount,
            .debt-date {
                text-align: left;
            }
        }
        
        /* Content sections visibility control */
        .content-section {
            display: none;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .content-section.active,
        .force-show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Initially show dashboard content - only when no other section is active */
        #dashboard-content:not(.hidden) {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Hide dashboard content when other sections are active */
        #dashboard-content.hidden {
            display: none !important;
        }
        
        /* Hide other content sections initially */
        #my-debts-content,
        #payments-content,
        #history-content,
        #settings-content {
            display: none;
        }
        
        /* Ensure content sections are properly positioned */
        #dashboard-content,
        #my-debts-content,
        #payments-content,
        #history-content,
        #settings-content {
            position: relative;
            z-index: 1;
            min-height: 400px;
        }
        
        /* Notification popup animation - Removed - notifications not used */
        /* @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification-popup {
            animation: slideIn 0.3s ease-out;
        } */
        
        /* DataTables Custom Styling */
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter,
        .dataTables_wrapper .dataTables_info,
        .dataTables_wrapper .dataTables_processing,
        .dataTables_wrapper .dataTables_paginate {
            color: #6c757d;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_filter input {
            border: 1px solid #ced4da;
            border-radius: 0.375rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_length select {
            border: 1px solid #ced4da;
            border-radius: 0.375rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            margin: 0 2px;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: #0d6efd;
            border-color: #0d6efd;
            color: white !important;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled {
            color: #6c757d !important;
            cursor: not-allowed;
        }
        
        /* Responsive table styling */
        .dataTables_wrapper .dataTables_scrollBody {
            border: 1px solid #dee2e6;
        }
        
        /* Table styling */
        #paymentHistoryTable, #debtsTable {
            margin-bottom: 0;
        }
        
        #paymentHistoryTable thead th, #debtsTable thead th {
            border-bottom: 2px solid #dee2e6;
            font-weight: 600;
        }
        
        #paymentHistoryTable tbody tr:hover, #debtsTable tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        /* DataTable responsive styling */
        #debtsTable {
            font-size: 0.9rem;
        }
        
        #debtsTable .badge {
            font-size: 0.75rem;
        }
        
        #debtsTable .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        
        /* DataTable wrapper styling */
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter,
        .dataTables_wrapper .dataTables_info,
        .dataTables_wrapper .dataTables_processing,
        .dataTables_wrapper .dataTables_paginate {
            color: #6c757d;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_filter input {
            border: 1px solid #ced4da;
            border-radius: 0.375rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_length select {
            border: 1px solid #ced4da;
            border-radius: 0.375rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            margin: 0 2px;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: #0d6efd;
            border-color: #0d6efd;
            color: white !important;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled {
            color: #6c757d !important;
            cursor: not-allowed;
        }
        
        /* Responsive table styling */
        .dataTables_wrapper .dataTables_scrollBody {
            border: 1px solid #dee2e6;
        }
        
        /* Modal table specific styling */
        #modalPaymentHistoryTable {
            width: 100% !important;
            table-layout: auto;
        }
        
        #modalPaymentHistoryTable_wrapper {
            width: 100%;
        }
        
        #modalPaymentHistoryTable_wrapper .dataTables_scrollBody {
            width: 100% !important;
        }
        
        /* Ensure modal table columns have proper width */
        #modalPaymentHistoryTable th,
        #modalPaymentHistoryTable td {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        #modalPaymentHistoryTable th:nth-child(1),
        #modalPaymentHistoryTable td:nth-child(1) {
            width: 25%;
        }
        
        #modalPaymentHistoryTable th:nth-child(2),
        #modalPaymentHistoryTable td:nth-child(2) {
            width: 20%;
        }
        
        #modalPaymentHistoryTable th:nth-child(3),
        #modalPaymentHistoryTable td:nth-child(3) {
            width: 25%;
        }
        
        #modalPaymentHistoryTable th:nth-child(4),
        #modalPaymentHistoryTable td:nth-child(4) {
            width: 30%;
        }
        
        /* Mobile responsive adjustments for modal table */
        @media (max-width: 768px) {
            #modalPaymentHistoryTable_wrapper .dataTables_length,
            #modalPaymentHistoryTable_wrapper .dataTables_filter {
                margin-bottom: 1rem;
            }
            
            #modalPaymentHistoryTable_wrapper .dataTables_length label,
            #modalPaymentHistoryTable_wrapper .dataTables_filter label {
                font-size: 0.875rem;
            }
            
            #modalPaymentHistoryTable th,
            #modalPaymentHistoryTable td {
                padding: 0.5rem 0.25rem;
                font-size: 0.875rem;
            }
        }
        
        /* Mobile debt cards styling */
        .debt-item {
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            margin-bottom: 1rem;
            padding: 1.25rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .debt-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .debt-item .creditor-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
        }
        
        .debt-item .creditor-initial {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .debt-item h6 {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.25rem;
        }
        
        .debt-item .text-muted {
            color: #6c757d !important;
            font-size: 0.875rem;
        }
        
        .debt-item .badge {
            font-size: 0.75rem;
            padding: 0.5rem 0.75rem;
            border-radius: 20px;
        }
        
        .debt-item .badge.bg-info {
            background-color: #17a2b8 !important;
        }
        
        .debt-item .badge.bg-success {
            background-color: #28a745 !important;
        }
        
        .debt-item .badge.bg-warning {
            background-color: #ffc107 !important;
            color: #212529 !important;
        }
        
        .debt-item .badge.bg-danger {
            background-color: #dc3545 !important;
        }
        
        .debt-item strong {
            color: #2c3e50;
            font-size: 1.1rem;
        }
        
        .debt-item .btn {
            border-radius: 8px;
            font-size: 0.875rem;
            padding: 0.5rem 1rem;
        }
        
        /* Mobile specific adjustments */
        @media (max-width: 768px) {
            .debt-item {
                padding: 1rem;
                margin-bottom: 0.75rem;
            }
            
            .debt-item .creditor-avatar {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
                margin-bottom: 0.5rem;
            }
            
            .debt-item h6 {
                font-size: 1rem;
            }
            
            .debt-item .btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            .debt-item .d-flex.gap-1 {
                gap: 0.5rem !important;
            }
        }
        
        /* Very small screens */
        @media (max-width: 576px) {
            .debt-item {
                padding: 0.75rem;
            }
            
            .debt-item .creditor-avatar {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .debt-item h6 {
                font-size: 0.95rem;
            }
            
            .debt-item strong {
                font-size: 1rem;
            }
            
            .debt-item .btn {
                font-size: 0.75rem;
                padding: 0.3rem 0.6rem;
            }
        }
        
        /* Additional improvements for better readability */
        .debt-item .row {
            margin: 0;
        }
        
        .debt-item .col-md-1,
        .debt-item .col-md-2,
        .debt-item .col-md-3 {
            padding: 0.25rem 0.5rem;
        }
        
        /* Better spacing for mobile */
        @media (max-width: 768px) {
            .debt-item .col-md-1,
            .debt-item .col-md-2,
            .debt-item .col-md-3 {
                padding: 0.25rem 0.25rem;
            }
        }
        
        /* Mobile Table Styles */
        .mobile-table {
            font-size: 0.8rem;
        }
        
        .mobile-table th,
        .mobile-table td {
            padding: 0.5rem 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .mobile-table th {
            font-size: 0.75rem;
            font-weight: 600;
            background-color: #f8f9fa;
        }
        
        .mobile-table td {
            font-size: 0.75rem;
        }
        
        .mobile-table .btn {
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
        }
        
        .mobile-table .badge {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
        }
        
        /* Horizontal scroll for mobile tables */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Ensure mobile tables are visible */
        @media (max-width: 991.98px) {
            .mobile-table {
                display: table !important;
                width: 100%;
                min-width: 600px; /* Minimum width to ensure readability */
            }
            
            .mobile-table th,
            .mobile-table td {
                display: table-cell !important;
            }
        }
        
        /* Very small mobile adjustments */
        @media (max-width: 576px) {
            .mobile-table {
                font-size: 0.7rem;
                min-width: 500px;
            }
            
            .mobile-table th,
            .mobile-table td {
                padding: 0.4rem 0.2rem;
                font-size: 0.7rem;
            }
            
            .mobile-table .btn {
                font-size: 0.65rem;
                padding: 0.15rem 0.3rem;
            }
            
            .mobile-table .badge {
                font-size: 0.6rem;
                padding: 0.15rem 0.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                <!-- Mobile Menu Button -->
                <div class="col-6 col-lg-3 d-lg-none">
                    <button class="btn btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu" aria-controls="mobileMenu" title="‡πÄ‡∏°‡∏ô‡∏π">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="h6 mb-0 text-white d-inline ms-2">
                        <i class="fas fa-user me-1"></i>
                        ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ
                    </h1>
                </div>
                
                <!-- Desktop Title -->
                <div class="col-lg-3 d-none d-lg-block">
                    <h1 class="h4 mb-0 text-white">
                        <i class="fas fa-user me-2"></i>
                        ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ
                    </h1>
                </div>
                
                <!-- Desktop Navigation Menu -->
                <div class="col-lg-6 d-none d-lg-block">
                    <nav class="nav justify-content-center">
                        <a class="nav-link active" href="#dashboard">
                            <i class="fas fa-tachometer-alt me-2"></i>
                            ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
                        </a>
                        <a class="nav-link" href="#my-debts">
                            <i class="fas fa-list me-2"></i>
                            ‡∏´‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
                        </a>
                        <a class="nav-link" href="#history">
                            <i class="fas fa-history me-2"></i>
                            ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                        </a>
                        <a class="nav-link" href="#settings">
                            <i class="fas fa-cog me-2"></i>
                            ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                        </a>
                        <a class="nav-link" href="#" onclick="confirmLogout()">
                            <i class="fas fa-sign-out-alt me-2"></i>
                            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                        </a>
                    </nav>
                </div>
                
                <!-- Right Side - User Info -->
                <div class="col-6 col-lg-3 text-end">
                    <div class="d-flex align-items-center justify-content-end">
                        
                        <!-- User Info -->
                        <span class="text-white d-none d-sm-inline">
                            <i class="fas fa-user me-1 me-md-2"></i>
                            <span id="userName" class="d-none d-md-inline">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Menu Offcanvas -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileMenu" aria-labelledby="mobileMenuLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="mobileMenuLabel">
                <i class="fas fa-user me-2"></i>
                ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <!-- User Info in Mobile Menu -->
            <div class="mb-4 p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                    <i class="fas fa-user-circle fa-2x text-primary me-3"></i>
                    <div>
                        <h6 class="mb-0" id="mobileUserName">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h6>
                        <small class="text-muted">‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</small>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Navigation Menu -->
            <nav class="nav flex-column">
                <a class="nav-link active mb-2" href="#dashboard" data-bs-dismiss="offcanvas">
                    <i class="fas fa-tachometer-alt me-2"></i>
                    ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
                </a>
                <a class="nav-link mb-2" href="#my-debts" data-bs-dismiss="offcanvas">
                    <i class="fas fa-list me-2"></i>
                    ‡∏´‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
                </a>
                <a class="nav-link mb-2" href="#history" data-bs-dismiss="offcanvas">
                    <i class="fas fa-history me-2"></i>
                    ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                </a>
                <a class="nav-link mb-2" href="#settings" data-bs-dismiss="offcanvas">
                    <i class="fas fa-cog me-2"></i>
                    ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                </a>
                <hr class="my-3">
                <a class="nav-link text-danger" href="#" onclick="confirmLogout()" data-bs-dismiss="offcanvas">
                    <i class="fas fa-sign-out-alt me-2"></i>
                    ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                </a>
            </nav>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <!-- Main Content -->
            <div class="col-12 main-content">
                <!-- Dashboard Content -->
                <div id="debtor-dashboard-content">
                    <!-- Stats Cards -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-icon primary">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <h3 class="h4 mb-1">‡∏ø<span id="debtorTotalDebt">0</span></h3>
                                <p class="text-muted mb-0">‡∏¢‡∏≠‡∏î‡∏´‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°</p>
                                <small class="text-muted d-block mt-1">
                                    ‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô: ‡∏ø<span id="totalPrincipal">0</span><br>
                                    ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢: ‡∏ø<span id="totalInterest">0</span>
                                </small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-icon success">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <h3 class="h4 mb-1">‡∏ø<span id="paidAmount">0</span></h3>
                                <p class="text-muted mb-0">‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß</p>
                                <small class="text-muted d-block mt-1">
                                    ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß: <span id="paidInstallments">0</span> ‡∏á‡∏ß‡∏î
                                </small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-icon warning">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <h3 class="h4 mb-1"><span id="debtorPendingDebts">0</span></h3>
                                <p class="text-muted mb-0">‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞</p>
                                <small class="text-muted d-block mt-1">
                                    ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <span id="remainingInstallments">0</span> ‡∏á‡∏ß‡∏î
                                </small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-icon danger">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <h3 class="h4 mb-1"><span id="debtorOverdueDebts">0</span></h3>
                                <p class="text-muted mb-0">‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
                                <small class="text-muted d-block mt-1">
                                    ‡∏á‡∏ß‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="totalInstallments">0</span> ‡∏á‡∏ß‡∏î
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="stats-card">
                                <h5 class="mb-3">
                                    <i class="fas fa-chart-pie me-2"></i>
                                    ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏ô‡∏µ‡πâ
                                </h5>
                                <div class="chart-container">
                                    <canvas id="debtorDebtStatusChart"></canvas>
                                    <div id="debtStatusLoading" class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
                                        </div>
                                        <p class="mt-2 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="stats-card">
                                <h5 class="mb-3">
                                    <i class="fas fa-chart-line me-2"></i>
                                    ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                                </h5>
                                <div class="chart-container">
                                    <canvas id="paymentTrendChart"></canvas>
                                    <div id="paymentTrendLoading" class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
                                        </div>
                                        <p class="mt-2 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Progress Section -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="stats-card">
                                <h5 class="mb-3">
                                    <i class="fas fa-trophy me-2"></i>
                                    ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                                </h5>
                                <div class="payment-progress-container">
                                    <!-- Overall Progress -->
                                    <div class="progress-item mb-4">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <h6 class="mb-0">
                                                <i class="fas fa-chart-line me-2 text-primary"></i>
                                                ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏ß‡∏°
                                            </h6>
                                            <span class="badge bg-primary fs-6" id="overallProgressPercent">0%</span>
                                        </div>
                                        <div class="progress mb-2" style="height: 12px;">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-gradient-primary" 
                                                 role="progressbar" 
                                                 id="overallProgressBar" 
                                                 style="width: 0%" 
                                                 aria-valuenow="0" 
                                                 aria-valuemin="0" 
                                                 aria-valuemax="100">
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <span class="text-muted">
                                                <i class="fas fa-check-circle me-1 text-success"></i>
                                                ‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß: <strong id="paidAmountProgress">0</strong> ‡∏ö‡∏≤‡∏ó
                                            </span>
                                            <span class="text-muted">
                                                <i class="fas fa-target me-1 text-info"></i>
                                                ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <strong id="totalAmount">0</strong> ‡∏ö‡∏≤‡∏ó
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Individual Debt Progress -->
                                    <!-- Removed duplicate section - using overall progress only -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Debt Overview Chart -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="stats-card">
                                <h5 class="mb-3">
                                    <i class="fas fa-chart-bar me-2"></i>
                                    ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                                </h5>
                                <div class="chart-container">
                                    <canvas id="debtOverviewChart"></canvas>
                                    <div id="debtOverviewLoading" class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
                                        </div>
                                        <p class="mt-2 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>




                </div>

                <!-- My Debts Content -->
                <div id="my-debts-content">
                    <div class="row">
                        <div class="col-12">
                            <div class="debt-list">
                                <div class="p-3 border-bottom">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>
                                        ‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
                                    </h5>
                                </div>
                                
                                <!-- Desktop DataTable View -->
                                <div class="d-none d-lg-block">
                                    <div class="table-responsive">
                                        <table id="debtsTable" class="table table-hover">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</th>
                                                    <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</th>
                                                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                                    <th class="text-end">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                                    <th class="text-end">‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î</th>
                                                    <th class="text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                                                </tr>
                                            </thead>
                                            <tbody id="debtsTableBody">
                                                <!-- Data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- Mobile Table View -->
                                <div class="d-lg-none">
                                    <div class="table-responsive">
                                        <table id="debtsTableMobile" class="table table-hover mobile-table">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</th>
                                                    <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</th>
                                                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                                    <th class="text-end">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                                    <th class="text-end">‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î</th>
                                                    <th class="text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                                                </tr>
                                            </thead>
                                            <tbody id="debtsTableBodyMobile">
                                                <!-- Data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- History Content -->
                <div id="history-content">
                    <div class="row">
                        <div class="col-12">
                            <div class="debt-list">
                                <div class="p-3 border-bottom">
                                    <h5 class="mb-0">
                                        <i class="fas fa-history me-2"></i>
                                        ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                                    </h5>
                                </div>
                                
                                <!-- Desktop DataTable View -->
                                <div class="d-none d-lg-block">
                                    <div class="table-responsive">
                                        <table id="paymentHistoryTable" class="table table-hover">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏ô‡∏µ‡πâ</th>
                                                    <th>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ</th>
                                                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                                    <th class="text-end">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                                    <th class="text-end">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞</th>
                                                </tr>
                                            </thead>
                                            <tbody id="debtorPaymentHistoryTableBody">
                                                <!-- Data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- Mobile Table View -->
                                <div class="d-lg-none">
                                    <div class="table-responsive">
                                        <table id="paymentHistoryTableMobile" class="table table-hover mobile-table">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏ô‡∏µ‡πâ</th>
                                                    <th>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ</th>
                                                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                                    <th class="text-end">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                                    <th class="text-end">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞</th>
                                                </tr>
                                            </thead>
                                            <tbody id="debtorPaymentHistoryTableBodyMobile">
                                                <!-- Data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Content -->
                <div id="debtor-settings-content">
                    <div class="row">
                        <div class="col-12">
                            <div class="stats-card">
                                <h5 class="mb-3">
                                    <i class="fas fa-cog me-2"></i>
                                    ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                                </h5>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="darkMode">
                                                <label class="form-check-label" for="darkMode">
                                                    ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="compactView">
                                                <label class="form-check-label" for="compactView">
                                                    ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏Å‡∏∞‡∏ó‡∏±‡∏î‡∏£‡∏±‡∏î
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-primary" onclick="saveSettings()">
                                    <i class="fas fa-save me-2"></i>
                                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                                </button>
                                

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment History Modal -->
    <div class="modal fade" id="debtorInstallmentPaymentModal" tabindex="-1" aria-labelledby="debtorInstallmentPaymentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="debtorInstallmentPaymentModalLabel">
                        <i class="fas fa-history me-2"></i>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <h6 class="text-primary mb-3">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞</h6>
                            <div class="card bg-light">
                                <div class="card-body">
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</strong></div>
                                        <div class="col-6" id="paymentModalTotalAmount">‡∏ø0</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞:</strong></div>
                                        <div class="col-6" id="debtorModalMonthlyPayment">‡∏ø0</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î:</strong></div>
                                        <div class="col-6" id="debtorModalTotalInstallments">0 ‡∏á‡∏ß‡∏î</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß:</strong></div>
                                        <div class="col-6" id="debtorModalPaidInstallments">0 ‡∏á‡∏ß‡∏î</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</strong></div>
                                        <div class="col-6" id="debtorModalRemainingInstallments">0 ‡∏á‡∏ß‡∏î</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</strong></div>
                                        <div class="col-6" id="paymentModalRemainingAmount">‡∏ø0</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 d-none" id="paymentSection">
                            <h6 class="text-primary mb-3">‡∏ä‡∏≥‡∏£‡∏∞‡∏á‡∏ß‡∏î‡∏ô‡∏µ‡πâ</h6>
                            <div class="mb-3">
                                <label for="debtorPaymentAmount" class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞:</label>
                                <input type="number" class="form-control" id="debtorPaymentAmount" min="0" step="0.01">
                            </div>
                            <div class="mb-3">
                                <label for="debtorPaymentDate" class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞:</label>
                                <input type="date" class="form-control" id="debtorPaymentDate">
                            </div>
                            <div class="mb-3">
                                <label for="debtorPaymentTime" class="form-label">‡πÄ‡∏ß‡∏•‡∏≤:</label>
                                <input type="time" class="form-control" id="debtorPaymentTime">
                            </div>
                            <div class="mb-3">
                                <label for="debtorPaymentNote" class="form-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
                                <textarea class="form-control" id="debtorPaymentNote" rows="2" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    <div class="row">
                        <div class="col-12">
                            <h6 class="text-primary mb-3">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞</h6>
                            <div class="table-responsive">
                                <table id="modalPaymentHistoryTable" class="table table-sm table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                            <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                                            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                        </tr>
                                    </thead>
                                    <tbody id="modalPaymentHistoryTableBody">
                                        <!-- Payment history will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer d-flex justify-content-end align-items-center">
                    <div class="d-flex gap-2">
                        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i>‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Debt Details Modal -->
    <div class="modal fade" id="debtDetailsModal" tabindex="-1" aria-labelledby="debtDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="debtDetailsModalLabel">
                        <i class="fas fa-info-circle me-2"></i>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏ô‡∏µ‡πâ
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡∏µ‡πâ</h6>
                            <div class="card bg-light">
                                <div class="card-body">
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ:</strong></div>
                                        <div class="col-6" id="modalCreditorName">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:</strong></div>
                                        <div class="col-6" id="modalDescription">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong></div>
                                        <div class="col-6" id="modalStatus">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:</strong></div>
                                        <div class="col-6" id="modalCreatedDate">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</strong></div>
                                        <div class="col-6" id="modalDueDate">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h6>
                            <div class="card bg-light">
                                <div class="card-body">
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô:</strong></div>
                                        <div class="col-6" id="modalPrincipal">‡∏ø0</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢:</strong></div>
                                        <div class="col-6" id="modalInterestRate">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢:</strong></div>
                                        <div class="col-6" id="modalInterest">‡∏ø0</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</strong></div>
                                        <div class="col-6" id="modalTotalAmount">‡∏ø0</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß:</strong></div>
                                        <div class="col-6" id="modalPaidAmount">‡∏ø0</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</strong></div>
                                        <div class="col-6" id="modalRemainingAmount">‡∏ø0</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    <div class="row">
                        <div class="col-12">
                            <h6 class="text-primary mb-3">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h6>
                            <div class="card bg-light">
                                <div class="card-body">
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞:</strong></div>
                                        <div class="col-6" id="modalPaymentType">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î:</strong></div>
                                        <div class="col-6" id="modalInstallments">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏á‡∏ß‡∏î‡∏•‡∏∞:</strong></div>
                                        <div class="col-6" id="debtorModalMonthlyPaymentDetail">-</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-6"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong></div>
                                        <div class="col-6" id="modalNotes">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer d-flex justify-content-end align-items-center">
                    <div class="d-flex gap-2">
                        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i>‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- jQuery (required for DataTables) - MUST be loaded first -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>
    
    <!-- DataTables Initialization -->
    <script src="../../js/datatables-init.js?v=2.1.0"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    
    <!-- Custom JS -->
    <script src="../../js/performance.js?v=4.0.0"></script>
    <script src="../../js/error-handler.js?v=4.0.0"></script>
    <script src="../../js/logger.js?v=4.0.0"></script>
    <script src="../../js/firebase-config.js?v=4.0.0"></script>
    <script src="../../js/firebase-utils.js?v=4.0.0"></script>
    <script src="../../js/security-utils.js?v=4.0.0"></script>
    <script src="../../js/alert-utils.js?v=4.0.0"></script>
    <script src="../../js/auth.js?v=4.0.0"></script>
    <script src="../../js/login.js?v=4.0.0"></script>
    <script src="../../js/responsive-nav.js?v=4.0.0"></script>
    <script src="debtor-dashboard.js"></script>
    
    <script>
        // Debug logging removed for production
        
        // Function to confirm logout
        function confirmLogout() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                // Show success message before logout
                if (typeof showToast === 'function') {
                    showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö...', 'info');
                }
                
                // Call the original logout function
                if (typeof logout === 'function') {
                    logout();
                } else {
                    // Fallback if logout function is not available
                    window.location.href = '../../index.html';
                }
            }
        }
        
        // Update mobile menu user name when main user name is updated
        function updateMobileUserName() {
            const mainUserName = document.getElementById('userName');
            const mobileUserName = document.getElementById('mobileUserName');
            
            if (mainUserName && mobileUserName) {
                mobileUserName.textContent = mainUserName.textContent;
            }
        }
        
        // Listen for changes to the main user name
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList' || mutation.type === 'characterData') {
                    updateMobileUserName();
                }
            });
        });
        
        // Start observing when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // ‡∏•‡πâ‡∏≤‡∏á redirect flag ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ dashboard
            sessionStorage.removeItem('isRedirecting');
            
            const userNameElement = document.getElementById('userName');
            if (userNameElement) {
                observer.observe(userNameElement, {
                    childList: true,
                    characterData: true,
                    subtree: true
                });
                // Initial update
                updateMobileUserName();
            }
            
            // Add click event listeners to mobile menu links
            setupMobileMenuNavigation();
            
            // Listen for hash changes
            window.addEventListener('hashchange', function() {
                const hash = window.location.hash || '#dashboard';
                updateMobileActiveNavLink(hash);
                showContentSection(hash);
            });
            
            // Initial navigation based on current hash
            const initialHash = window.location.hash || '#dashboard';
            updateMobileActiveNavLink(initialHash);
            showContentSection(initialHash);
        });
        
        // Setup mobile menu navigation
        function setupMobileMenuNavigation() {
            const mobileMenuLinks = document.querySelectorAll('.offcanvas-body .nav-link[href^="#"]');
            
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const href = this.getAttribute('href');
                    
                    // Call the navigation function if it exists
                    if (typeof handleNavigation === 'function') {
                        handleNavigation(href);
                    } else {
                        // Fallback: manually handle navigation
                        window.location.hash = href;
                        updateMobileActiveNavLink(href);
                        showContentSection(href);
                    }
                });
            });
        }
        
        // Update active nav link in mobile menu
        function updateMobileActiveNavLink(href) {
            // Remove active class from all mobile menu links (both desktop and mobile)
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Add active class to current mobile menu link
            const mobileActiveLink = document.querySelector(`.offcanvas-body .nav-link[href="${href}"]`);
            if (mobileActiveLink) {
                mobileActiveLink.classList.add('active');
            }
            
            // Also update desktop navigation if it exists
            const desktopActiveLink = document.querySelector(`header .nav-link[href="${href}"]`);
            if (desktopActiveLink) {
                desktopActiveLink.classList.add('active');
            }
        }
        
        // Show content section based on hash
        function showContentSection(href) {
            // Hide all content sections
            const sections = ['dashboard-content', 'my-debts-content', 'history-content', 'settings-content'];
            sections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.style.display = 'none';
                }
            });
            
            // Show the appropriate section
            let targetSectionId = 'dashboard-content'; // default
            
            switch (href) {
                case '#dashboard':
                    targetSectionId = 'dashboard-content';
                    break;
                case '#my-debts':
                    targetSectionId = 'my-debts-content';
                    break;
                case '#history':
                    targetSectionId = 'history-content';
                    break;
                case '#settings':
                    targetSectionId = 'settings-content';
                    break;
            }
            
            const targetSection = document.getElementById(targetSectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }
    </script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('../../sw.js')
                    .then(registration => {
                        // Service Worker registered successfully
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
